"undefined"==typeof window.Mozilla.Analytics&&(window.Mozilla.Analytics={}),function(){"use strict";var e=Mozilla.Analytics,t="querySelector"in document&&"querySelectorAll"in document;e.pageHasDownload=function(){return t&&null!==document.querySelector("[data-download-os]")?"true":"false"},e.pageHasVideo=function(){return t&&(null!==document.querySelector("video")||null!==document.querySelector('iframe[src^="https://www.youtube"]'))?"true":"false"},e.getPageVersion=function(e){var t=e||document.location.pathname,o=/firefox\/(\d+(?:\.\d+)?\.\da?\d?)/.exec(t);return o?o[1]:null},e.getLatestFxVersion=function(){return document.getElementsByTagName("html")[0].getAttribute("data-latest-firefox")},e.isWin10S=function(e){if(!(-1<(e=e||navigator.userAgent).indexOf("Edge")))return!1;try{var t=JSON.parse(window.external.getHostEnvironmentValue("os-mode"));return!(!t||"2"!==t["os-mode"])}catch(o){return!1}},e.getAMOExperiment=function(e){if(Object.prototype.hasOwnProperty.call(e,"experiment")&&Object.prototype.hasOwnProperty.call(e,"variation")){var t=decodeURIComponent(e.experiment),o=decodeURIComponent(e.variation);if(/^\d{8}_amo_.[\w/.%-]{1,50}$/.test(t)&&/^[\w/.%-]{1,50}$/.test(o))return{experiment:t,variation:o}}return null},e.formatFxaDetails=function(e){var t={};if(!0===e.firefox)if(e.mobile)t.FxASegment="Firefox Mobile";else if(e.setup){t.FxALogin=!0,t.FxASegment="Logged in",!0===e.legacy&&(t.FxASegment="Legacy Firefox");var o=e.browserServices.sync?e.browserServices.sync.mobileDevices:null,n=e.browserServices.sync?e.browserServices.sync.desktopDevices:null;t.FxAMobileSync=0<o||0!==o&&"unknown",t.FxAMultiDesktopSync=1<n||1!==n&&(0!==n&&"unknown"),1<n&&0<o?t.FxASegment="Multi-Desktop and Mobile Sync":1===n&&0<o?t.FxASegment="Desktop and Mobile Sync":1<n&&(t.FxASegment="Multi-Desktop Sync")}else!0===e.legacy?(t.FxASegment="Legacy Firefox",t.FxALogin="unknown"):(t.FxASegment="Not logged in",t.FxALogin=!1);else t.FxASegment="Not Firefox";return t},e.updateDataLayerPush=function(e){var a=window.dataLayer=window.dataLayer||[],i=e||document.location.hostname;a.defaultPush=a.push,a.push=function(){for(var e=0;e<arguments.length;e++)if("gtm.linkClick"===arguments[e].event){var t=arguments[e]["gtm.element"],o=t.href;if(t.hostname===i){var n=o.replace(/^(?:https?:\/\/)(?:[^/])*/,""),r=n.match(/^(\/\w{2}-\w{2}\/|\/\w{2,3}\/)/);n=r?n.replace(r[0],"/"):n,arguments[e].newClickHref=n}else arguments[e].newClickHref=o;a.defaultPush(arguments[e])}else a.defaultPush(arguments[e])}}}(),function(){"use strict";var n=Mozilla.Analytics,r=Mozilla.Client,a=window.dataLayer=window.dataLayer||[],i=!1,l=!1;function c(){i&&l&&function e(){var e={event:"core-datalayer-loaded",pageHasDownload:n.pageHasDownload(),pageHasVideo:n.pageHasVideo(),pageVersion:n.getPageVersion(),testPilotUser:"testpilotAddon"in navigator?"true":"false",releaseWindowVersion:n.getLatestFxVersion(),win10SUser:n.isWin10S()};a.push(e)}()}"undefined"!=typeof Mozilla.Utils&&Mozilla.Utils.onDocumentReady(function(){if(function e(){r.getFxaDetails(function(e){a.push(n.formatFxaDetails(e)),l=!0,c()}),r.isFirefoxDesktop||r.isFirefoxAndroid?r.getFirefoxDetails(function(e){a.push(e),i=!0,c()}):(i=!0,c()),n.updateDataLayerPush()}(),"undefined"!=typeof window._SearchParams){var t=(new window._SearchParams).params,o=n.getAMOExperiment(t);o&&a.push({"data-ex-name":o.experiment,"data-ex-variant":o.variation})}})}(),"undefined"==typeof window.Mozilla&&(window.Mozilla={}),function(){"use strict";var s={},p=["https://accounts.firefox.com/","https://accounts.firefox.com.cn/","https://accounts.stage.mozaws.net/","https://monitor.firefox.com/","https://getpocket.com/","https://latest.dev.lcip.org/","https://stable.dev.lcip.org/","https://vpn.mozilla.org/","https://stage-vpn.guardian.nonprod.cloudops.mozgcp.net/","https://guardian-dev.herokuapp.com/"],c=["utm_source","utm_campaign","utm_content","utm_term","utm_medium"],u=["device_id","flow_id","flow_begin_time","entrypoint_experiment","entrypoint_variation"],i=c.concat(u,["source"]);s.getHostName=function(e){var t=e.match(/^https?:\/\/(?:[^/?#]+)(?:[/?#]|$)/i);return t&&t[0]},s.getAttributionData=function(e){for(var t=/^[\w/.%-]+$/,o={},n=0;n<i.length;n++){var r=i[n];if(Object.prototype.hasOwnProperty.call(e,r)){var a=decodeURIComponent(e[r]);t.test(a)&&(o[r]=a)}}if(Object.prototype.hasOwnProperty.call(o,"source")){if(-1!==o.source.indexOf("whatsnew")||-1!==o.source.indexOf("welcome"))return-1!==o.source.indexOf("whatsnew")?(o.utm_source="www.mozilla.org-whatsnew",o.entrypoint="www.mozilla.org-whatsnew"):(o.utm_source="www.mozilla.org-welcome",o.entrypoint="www.mozilla.org-welcome"),o.utm_campaign=o.source,delete o.source,o;delete o.source}return Object.prototype.hasOwnProperty.call(o,"entrypoint_experiment")&&Object.prototype.hasOwnProperty.call(o,"entrypoint_variation")||(Object.prototype.hasOwnProperty.call(o,"device_id")&&delete o.device_id,Object.prototype.hasOwnProperty.call(o,"flow_id")&&delete o.flow_id,Object.prototype.hasOwnProperty.call(o,"flow_begin_time")&&delete o.flow_begin_time),Object.prototype.hasOwnProperty.call(o,"utm_source")&&Object.prototype.hasOwnProperty.call(o,"utm_campaign")||Object.prototype.hasOwnProperty.call(o,"entrypoint_experiment")&&Object.prototype.hasOwnProperty.call(o,"entrypoint_variation")?o:null},s.appendToDownloadURL=function(e,t){var o,n;if(0<e.indexOf("?")){if(n=window._SearchParams.queryStringToObject(e.split("?")[1]),Object.prototype.hasOwnProperty.call(t,"utm_source")&&Object.prototype.hasOwnProperty.call(t,"utm_campaign"))for(var r=0;r<c.length;r++){var a=c[r];Object.prototype.hasOwnProperty.call(n,a)&&delete n[a]}if(Object.prototype.hasOwnProperty.call(t,"entrypoint_experiment")&&Object.prototype.hasOwnProperty.call(t,"entrypoint_variation"))for(var i=0;i<u.length;i++){var l=u[i];Object.prototype.hasOwnProperty.call(n,l)&&delete n[l]}o=Object.assign(n,t)}else o=t;return e.split("?")[0]+"?"+window._SearchParams.objectToQueryString(o)},s.init=function(e){var t=s.getAttributionData(e),o=document.querySelectorAll(".js-fxa-cta-link, .js-vpn-cta-link");if(t&&"function"==typeof Object.assign)for(var n=0;n<o.length;n++){var r=o[n].hasAttribute("href")?o[n].href:null;if(r){var a=s.getHostName(r);if(a&&-1!==p.indexOf(a)){var i=o[n].getAttribute("data-mozillaonline-link"),l=s.appendToDownloadURL(r,t);if(o[n].href=l,i){var c=s.appendToDownloadURL(i,t);o[n].setAttribute("data-mozillaonline-link",c)}}}}},window.Mozilla.UtmUrl=s}(),function(){"use strict";var e=new window._SearchParams;Mozilla.UtmUrl.init(e.params)}();